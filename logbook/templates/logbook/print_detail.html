<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <title>Laporan - {{ log.tanggal }}</title>
    {% load tz %}
    <style>
        body { font-family: serif; padding: 40px; max-width: 800px; margin: 0 auto; color: #000; }
        .header { text-align: center; border-bottom: 2px solid #000; padding-bottom: 15px; margin-bottom: 20px; }
        .meta-table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }
        .meta-table td { padding: 4px; vertical-align: top; }
        .label { font-weight: bold; width: 160px; }
        .hv-box, .status-box { border: 1px solid #000; padding: 12px; margin-bottom: 20px; }
        .hv-grid { display: grid; grid-template-columns: repeat(5, 1fr); gap: 10px; } /* */
        .status-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .item { display: flex; flex-direction: column; border-bottom: 1px dotted #ccc; padding-bottom: 3px; }
        .item-label { font-size: 10px; text-transform: uppercase; color: #444; }
        .item-val { font-weight: bold; font-size: 13px; }
        .footer { margin-top: 40px; display: flex; justify-content: space-between; text-align: center; }
        .sig { margin-top: 50px; border-top: 1px solid #000; width: 200px; font-weight: bold; padding-top: 5px; margin-left: auto; margin-right: auto; }
        @media print { .no-print { display: none; } }
    </style>
</head>
<body onload="window.print()">
    <div class="header">
        <h1>LAPORAN LOGBOOK HARIAN</h1>
        <p>Badan Meteorologi, Klimatologi, dan Geofisika<br>Stasiun Geofisika Kelas I Jayapura</p>
    </div>

    <table class="meta-table">
        <tr><td class="label">Tanggal</td><td>: {{ log.tanggal|date:"d F Y" }}</td></tr>
        <tr><td class="label">Waktu Input</td><td>: {{ log.waktu_dibuat|timezone:"Asia/Jayapura"|date:"H:i:s" }} WIT</td></tr>
        <tr><td class="label">Shift</td><td>: {{ log.shift }}</td></tr>
        <tr><td class="label">Petugas Jaga</td><td>: {{ log.petugas.username|title }}</td></tr>
        <tr><td class="label">Status Absen</td><td>: {{ log.status_absen }}</td></tr>
        <tr><td class="label">Handover</td><td>: 
            {% if log.status_absen == 'Masuk' %}Ganti: {% for p in log.petugas_sebelum.all %}{{ p.username|title }}{% if not forloop.last %}, {% endif %}{% endfor %}
            {% else %}Diganti: {% for p in log.petugas_selanjutnya.all %}{{ p.username|title }}{% if not forloop.last %}, {% endif %}{% endfor %}{% endif %}
        </td></tr>
    </table>

    {% if log.hv_counter_hour or log.hv_jam_pasang %}
    <h4 style="margin: 0 0 5px 0;">DATA HV SAMPLER</h4>
    <div class="hv-box">
        <div class="hv-grid">
            <div class="item"><span class="item-label">Jam Pasang</span><span class="item-val">{{ log.hv_jam_pasang|default:"-" }}</span></div>
            <div class="item"><span class="item-label">Jam Angkat</span><span class="item-val">{{ log.hv_jam_angkat|default:"-" }}</span></div>
            <div class="item"><span class="item-label">Counter</span><span class="item-val">{{ log.hv_counter_hour|default:"-" }}</span></div>
            <div class="item"><span class="item-label">Flow Rate</span><span class="item-val">{{ log.hv_flow_rate|default:"-" }}</span></div>
            <div class="item"><span class="item-label">Berat Kertas</span><span class="item-val">{{ log.hv_berat_kertas|default:"-" }} gr</span></div>
        </div>
    </div>
    {% endif %}

    <h4 style="margin: 0 0 5px 0;">STATUS PERALATAN</h4>
    <div class="status-box">
        <div class="status-grid">
            <div class="item"><span class="item-label">Seiscomp Seismik</span><span class="item-val">{{ log.seiscomp_seismik }}</span></div>
            <div class="item"><span class="item-label">Seiscomp Accelero</span><span class="item-val">{{ log.seiscomp_accelero }}</span></div>
            <div class="item"><span class="item-label">ESDX</span><span class="item-val">{{ log.esdx }}</span></div>
            <div class="item"><span class="item-label">Petir</span><span class="item-val">{{ log.petir }}</span></div>
            <div class="item"><span class="item-label">LEMI</span><span class="item-val">{{ log.lemi }}</span></div>
            <div class="item"><span class="item-label">Proton</span><span class="item-val">{{ log.proton }}</span></div>
        </div>
    </div>

    <h4 style="margin: 0 0 5px 0;">CATATAN TAMBAHAN</h4>
    <div class="status-box" style="min-height: 80px;">{{ log.catatan|linebreaks|default:"-" }}</div>

    <div class="footer">
        <div style="width: 40%;"><p>Mengetahui,</p><p>Koordinator/Kepala</p><div class="sig"></div></div>
        <div style="width: 40%;"><p>Jayapura, {{ log.tanggal|date:"d F Y" }}</p><p>Petugas Jaga,</p><div class="sig">{{ log.petugas.username|title }}</div></div>
    </div>
</body>
</html>